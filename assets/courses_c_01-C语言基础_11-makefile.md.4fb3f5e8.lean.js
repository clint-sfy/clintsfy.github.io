import{_ as i}from"./chunks/ArticleMetadata.e10718d6.js";import{_ as y,v as n,b as e,E as m,O as d,F as s,L as c,R as l,M as C,C as h,B as A}from"./chunks/framework.2aeb816e.js";import"./chunks/md5.772bbdf1.js";const P=JSON.parse('{"title":"C语言makefile","description":"","frontmatter":{"title":"C语言makefile","author":"阿源","date":"2023/01/11 11:15","categories":["C基础快速入门"],"tags":["C","C基础"]},"headers":[],"relativePath":"courses/c/01-C语言基础/11-makefile.md","filePath":"courses/c/01-C语言基础/11-makefile.md","lastUpdated":1691327334000}'),f={name:"courses/c/01-C语言基础/11-makefile.md"},F=s("h1",{id:"c语言makefile",tabindex:"-1"},[c("C语言makefile "),s("a",{class:"header-anchor",href:"#c语言makefile","aria-label":'Permalink to "C语言makefile"'},"​")],-1),g=l(`<h2 id="makefile的概述" tabindex="-1">makefile的概述 <a class="header-anchor" href="#makefile的概述" aria-label="Permalink to &quot;makefile的概述&quot;">​</a></h2><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">gcc a.c b.c c.c ‐o main</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">gcc a.c b.c c.c ‐o main</span></span></code></pre></div><p>如果只修改了b.c 使用gcc编译 需要对所有文件重新编译。</p><p>make 是个命令，是个可执行程序，用来解析 Makefile 文件的命令</p><p>makefile 是个文件，这个文件中描述了咱们程序的编译规则。</p><p>采用 Makefile 的好处：</p><p>1、简化编译程序的时候输入得命令，编译的时候只需要敲 make 命令就可以了</p><p>2、可以节省编译时间，提高编译效率</p><h2 id="makefile的语法规则" tabindex="-1">makefile的语法规则 <a class="header-anchor" href="#makefile的语法规则" aria-label="Permalink to &quot;makefile的语法规则&quot;">​</a></h2><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;"> 目标:依赖文件</span></span>
<span class="line"><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;"> 命令列表</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;"> 目标:依赖文件</span></span>
<span class="line"><span style="color:#005CC5;">2</span><span style="color:#24292E;"> 命令列表</span></span></code></pre></div><p>gcc a.c b.c c.c -o main</p><p>目标：就是需要生成的文件</p><p>依赖文件：通过依赖文件 生成 目标文件</p><p>命令列表：实现 将依赖文件 生成 目标文件</p><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;"> main:a.c b.c c.c</span></span>
<span class="line"><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;"> gcc a.c b.c c.c ‐o main</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;"> main:a.c b.c c.c</span></span>
<span class="line"><span style="color:#005CC5;">2</span><span style="color:#24292E;"> gcc a.c b.c c.c ‐o main</span></span></code></pre></div><div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">main:</span><span style="color:#FF938A;font-style:italic;">00_code.c</span></span>
<span class="line"><span style="color:#ADBAC7;">gcc </span><span style="color:#FF938A;font-style:italic;">00_code.c</span><span style="color:#ADBAC7;"> ‐o main</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">main:</span><span style="color:#B31D28;font-style:italic;">00_code.c</span></span>
<span class="line"><span style="color:#24292E;">gcc </span><span style="color:#B31D28;font-style:italic;">00_code.c</span><span style="color:#24292E;"> ‐o main</span></span></code></pre></div><p>make 默认在工作目录中寻找名为 GNUmakefile、makefile、Makefile 的文件作为</p><p>makefile 输入文件</p><p>make -f 自定义makefle文件名</p><p>make 工具默认会实现 makefile 文件内的第一个目标。</p><p>make 目标 -----&gt;选择目标执行</p><h2 id="makefile的变量" tabindex="-1">makefile的变量 <a class="header-anchor" href="#makefile的变量" aria-label="Permalink to &quot;makefile的变量&quot;">​</a></h2><h3 id="_1、自定义变量" tabindex="-1">1、自定义变量 <a class="header-anchor" href="#_1、自定义变量" aria-label="Permalink to &quot;1、自定义变量&quot;">​</a></h3><p>1 变量名=变量值</p>`,24),B={变量名:""},D={class:"MathJax",jax:"SVG",style:{direction:"ltr",position:"relative"}},u={style:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"10.81ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 4778 1000","aria-hidden":"true"},k=l('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(389,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">变</text></g><g data-mml-node="mi" transform="translate(1389,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">量</text></g><g data-mml-node="mi" transform="translate(2389,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">名</text></g><g data-mml-node="mo" transform="translate(3389,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(3778,0)"><text data-variant="normal" transform="scale(1,-1)" font-size="884px" font-family="serif">或</text></g></g></g>',1),b=[k],v=s("mjx-assistive-mml",{unselectable:"on",display:"inline",style:{top:"0px",left:"0px",clip:"rect(1px, 1px, 1px, 1px)","-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none",position:"absolute",padding:"1px 0px 0px 0px",border:"0px",display:"block",width:"auto",overflow:"hidden"}},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("mo",{stretchy:"false"},"("),s("mi",{mathvariant:"normal"},"变"),s("mi",{mathvariant:"normal"},"量"),s("mi",{mathvariant:"normal"},"名"),s("mo",{stretchy:"false"},")"),s("mi",{mathvariant:"normal"},"或")])],-1),x=l(`<div class="language-c vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;"> cc</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">gcc</span></span>
<span class="line"><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;"> exec</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">main</span></span>
<span class="line"><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;"> obj</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">main.o fun.o</span></span>
<span class="line"><span style="color:#6CB6FF;">4</span><span style="color:#ADBAC7;"> $(exec):$(obj)</span></span>
<span class="line"><span style="color:#6CB6FF;">5</span><span style="color:#ADBAC7;"> $(cc) $(obj) ‐o $(exec)</span></span>
<span class="line"><span style="color:#6CB6FF;">6</span><span style="color:#ADBAC7;"> main.o:main.c</span></span>
<span class="line"><span style="color:#6CB6FF;">7</span><span style="color:#ADBAC7;"> $(cc) ‐c main.c ‐o main.o</span></span>
<span class="line"><span style="color:#6CB6FF;">8</span><span style="color:#ADBAC7;"> fun.o:fun.c</span></span>
<span class="line"><span style="color:#6CB6FF;">9</span><span style="color:#ADBAC7;"> $(cc) ‐c fun.c ‐o fun.o</span></span>
<span class="line"><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;"> clean:</span></span>
<span class="line"><span style="color:#6CB6FF;">11</span><span style="color:#ADBAC7;"> rm </span><span style="color:#F47067;">*</span><span style="color:#ADBAC7;">.o $(exec)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;"> cc</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">gcc</span></span>
<span class="line"><span style="color:#005CC5;">2</span><span style="color:#24292E;"> exec</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">main</span></span>
<span class="line"><span style="color:#005CC5;">3</span><span style="color:#24292E;"> obj</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">main.o fun.o</span></span>
<span class="line"><span style="color:#005CC5;">4</span><span style="color:#24292E;"> $(exec):$(obj)</span></span>
<span class="line"><span style="color:#005CC5;">5</span><span style="color:#24292E;"> $(cc) $(obj) ‐o $(exec)</span></span>
<span class="line"><span style="color:#005CC5;">6</span><span style="color:#24292E;"> main.o:main.c</span></span>
<span class="line"><span style="color:#005CC5;">7</span><span style="color:#24292E;"> $(cc) ‐c main.c ‐o main.o</span></span>
<span class="line"><span style="color:#005CC5;">8</span><span style="color:#24292E;"> fun.o:fun.c</span></span>
<span class="line"><span style="color:#005CC5;">9</span><span style="color:#24292E;"> $(cc) ‐c fun.c ‐o fun.o</span></span>
<span class="line"><span style="color:#005CC5;">10</span><span style="color:#24292E;"> clean:</span></span>
<span class="line"><span style="color:#005CC5;">11</span><span style="color:#24292E;"> rm </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.o $(exec)</span></span></code></pre></div><h3 id="_2、系统环境变量" tabindex="-1"><strong>2、系统环境变量</strong> <a class="header-anchor" href="#_2、系统环境变量" aria-label="Permalink to &quot;**2、系统环境变量**&quot;">​</a></h3><p>make 可以识别系统环境变量，在 makefile 中可直接读取或修改拷贝后的变量</p><p>查看环境变量：env</p><h3 id="_3、预定义变量" tabindex="-1">3、预定义变量 <a class="header-anchor" href="#_3、预定义变量" aria-label="Permalink to &quot;3、预定义变量&quot;">​</a></h3><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/img/c/makefile.png" alt=""></p><div class="language-make vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">make</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">1 cc=gcc</span></span>
<span class="line"><span style="color:#ADBAC7;">2 exec=main</span></span>
<span class="line"><span style="color:#ADBAC7;">3 obj=main.o fun.o</span></span>
<span class="line"><span style="color:#ADBAC7;">4 flags=‐Wall</span></span>
<span class="line"><span style="color:#DCBDFB;">5</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">$(</span><span style="color:#ADBAC7;">exec</span><span style="color:#96D0FF;">)</span><span style="color:#ADBAC7;">:</span><span style="color:#96D0FF;">$(</span><span style="color:#ADBAC7;">obj</span><span style="color:#96D0FF;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">6 </span><span style="color:#96D0FF;">$(</span><span style="color:#ADBAC7;">cc</span><span style="color:#96D0FF;">)</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">$^</span><span style="color:#ADBAC7;"> ‐o </span><span style="color:#6CB6FF;">$@</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">$(</span><span style="color:#ADBAC7;">flags</span><span style="color:#96D0FF;">)</span></span>
<span class="line"><span style="color:#DCBDFB;">7</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">%</span><span style="color:#DCBDFB;">.o</span><span style="color:#ADBAC7;">:</span><span style="color:#F47067;">%</span><span style="color:#ADBAC7;">.c</span></span>
<span class="line"><span style="color:#ADBAC7;">8 </span><span style="color:#96D0FF;">$(</span><span style="color:#ADBAC7;">cc</span><span style="color:#96D0FF;">)</span><span style="color:#ADBAC7;"> ‐c </span><span style="color:#6CB6FF;">$&lt;</span><span style="color:#ADBAC7;"> ‐o </span><span style="color:#6CB6FF;">$@</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">$(</span><span style="color:#ADBAC7;">flags</span><span style="color:#96D0FF;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">9</span></span>
<span class="line"><span style="color:#DCBDFB;">10</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">clean</span><span style="color:#ADBAC7;">:</span></span>
<span class="line"><span style="color:#ADBAC7;">11 rm </span><span style="color:#96D0FF;">$(</span><span style="color:#ADBAC7;">obj</span><span style="color:#96D0FF;">)</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">$(</span><span style="color:#ADBAC7;">exec</span><span style="color:#96D0FF;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">1 cc=gcc</span></span>
<span class="line"><span style="color:#24292E;">2 exec=main</span></span>
<span class="line"><span style="color:#24292E;">3 obj=main.o fun.o</span></span>
<span class="line"><span style="color:#24292E;">4 flags=‐Wall</span></span>
<span class="line"><span style="color:#6F42C1;">5</span><span style="color:#24292E;"> </span><span style="color:#032F62;">$(</span><span style="color:#24292E;">exec</span><span style="color:#032F62;">)</span><span style="color:#24292E;">:</span><span style="color:#032F62;">$(</span><span style="color:#24292E;">obj</span><span style="color:#032F62;">)</span></span>
<span class="line"><span style="color:#24292E;">6 </span><span style="color:#032F62;">$(</span><span style="color:#24292E;">cc</span><span style="color:#032F62;">)</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">$^</span><span style="color:#24292E;"> ‐o </span><span style="color:#005CC5;">$@</span><span style="color:#24292E;"> </span><span style="color:#032F62;">$(</span><span style="color:#24292E;">flags</span><span style="color:#032F62;">)</span></span>
<span class="line"><span style="color:#6F42C1;">7</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">%</span><span style="color:#6F42C1;">.o</span><span style="color:#24292E;">:</span><span style="color:#005CC5;">%</span><span style="color:#24292E;">.c</span></span>
<span class="line"><span style="color:#24292E;">8 </span><span style="color:#032F62;">$(</span><span style="color:#24292E;">cc</span><span style="color:#032F62;">)</span><span style="color:#24292E;"> ‐c </span><span style="color:#005CC5;">$&lt;</span><span style="color:#24292E;"> ‐o </span><span style="color:#005CC5;">$@</span><span style="color:#24292E;"> </span><span style="color:#032F62;">$(</span><span style="color:#24292E;">flags</span><span style="color:#032F62;">)</span></span>
<span class="line"><span style="color:#24292E;">9</span></span>
<span class="line"><span style="color:#6F42C1;">10</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">clean</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">11 rm </span><span style="color:#032F62;">$(</span><span style="color:#24292E;">obj</span><span style="color:#032F62;">)</span><span style="color:#24292E;"> </span><span style="color:#032F62;">$(</span><span style="color:#24292E;">exec</span><span style="color:#032F62;">)</span></span></code></pre></div>`,7);function E(a,_,$,T,w,j){const t=i,r=C("ClientOnly");return n(),e("div",null,[F,m(r,null,{default:d(()=>{var o,p;return[(((o=a.$frontmatter)==null?void 0:o.aside)??!0)&&(((p=a.$frontmatter)==null?void 0:p.showArticleMetadata)??!0)?(n(),h(t,{key:0,article:a.$frontmatter},null,8,["article"])):A("",!0)]}),_:1}),g,s("p",B,[c("引用变量： "),s("mjx-container",D,[(n(),e("svg",u,b)),v])]),x])}const H=y(f,[["render",E]]);export{P as __pageData,H as default};
