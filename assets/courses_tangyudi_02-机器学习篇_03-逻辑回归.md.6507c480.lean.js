import{_ as t}from"./chunks/ArticleMetadata.59a467b2.js";import{_ as c,v as l,b as r,t as y,O as C,F as p,L as A,R as F,M as i,C as D,B}from"./chunks/framework.5cbdba25.js";import"./chunks/md5.02486a14.js";const w=JSON.parse('{"title":"逻辑回归","description":"","frontmatter":{"title":"逻辑回归","author":"阿源","date":"2023/07/03 12:00","categories":["机器学习快速入门"],"tags":["机器学习"]},"headers":[],"relativePath":"courses/tangyudi/02-机器学习篇/03-逻辑回归.md","filePath":"courses/tangyudi/02-机器学习篇/03-逻辑回归.md","lastUpdated":1691327334000}'),E={name:"courses/tangyudi/02-机器学习篇/03-逻辑回归.md"},d=p("h1",{id:"逻辑回归",tabindex:"-1"},[A("逻辑回归 "),p("a",{class:"header-anchor",href:"#逻辑回归","aria-label":'Permalink to "逻辑回归"'},"​")],-1),g=F(`<h2 id="_5-逻辑回归原理" tabindex="-1">5. 逻辑回归原理 <a class="header-anchor" href="#_5-逻辑回归原理" aria-label="Permalink to &quot;5.  逻辑回归原理&quot;">​</a></h2><h2 id="_6-逻辑回归代码实现" tabindex="-1">6. 逻辑回归代码实现 <a class="header-anchor" href="#_6-逻辑回归代码实现" aria-label="Permalink to &quot;6. 逻辑回归代码实现&quot;">​</a></h2><h2 id="_7-逻辑回归实验分析" tabindex="-1">7. 逻辑回归实验分析 <a class="header-anchor" href="#_7-逻辑回归实验分析" aria-label="Permalink to &quot;7.  逻辑回归实验分析&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#adbac7;">回归是如何变成分类的呢？</span></span>
<span class="line"><span style="color:#adbac7;">之前在线性回归问题中，得到了具体的回归值，如果此时任务要做一个二分类该怎么办呢？</span></span>
<span class="line"><span style="color:#adbac7;"></span></span>
<span class="line"><span style="color:#adbac7;">如果可以将连续的数值转换成对应的区间，这样就可以完成分类任务了，逻辑回归中借助sigmoid函数完成了数值映射，通过概率值比较来完成分类任务</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">回归是如何变成分类的呢？</span></span>
<span class="line"><span style="color:#24292e;">之前在线性回归问题中，得到了具体的回归值，如果此时任务要做一个二分类该怎么办呢？</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">如果可以将连续的数值转换成对应的区间，这样就可以完成分类任务了，逻辑回归中借助sigmoid函数完成了数值映射，通过概率值比较来完成分类任务</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> numpy </span><span style="color:#F47067;">as</span><span style="color:#ADBAC7;"> np</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> os</span></span>
<span class="line"><span style="color:#F47067;">%</span><span style="color:#ADBAC7;">matplotlib inline</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> matplotlib</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> matplotlib.pyplot </span><span style="color:#F47067;">as</span><span style="color:#ADBAC7;"> plt</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.rcParams[</span><span style="color:#96D0FF;">&#39;axes.labelsize&#39;</span><span style="color:#ADBAC7;">] </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">14</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.rcParams[</span><span style="color:#96D0FF;">&#39;xtick.labelsize&#39;</span><span style="color:#ADBAC7;">] </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">12</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.rcParams[</span><span style="color:#96D0FF;">&#39;ytick.labelsize&#39;</span><span style="color:#ADBAC7;">] </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">12</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> warnings</span></span>
<span class="line"><span style="color:#ADBAC7;">warnings.filterwarnings(</span><span style="color:#96D0FF;">&#39;ignore&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">np.random.seed(</span><span style="color:#6CB6FF;">42</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">t </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.linspace(</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">100</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">sig </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">/</span><span style="color:#ADBAC7;"> (</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">+</span><span style="color:#ADBAC7;"> np.exp(</span><span style="color:#F47067;">-</span><span style="color:#ADBAC7;">t))</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.figure(</span><span style="color:#F69D50;">figsize</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">9</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">))</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot([</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">], [</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">], </span><span style="color:#96D0FF;">&quot;k-&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot([</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">], [</span><span style="color:#6CB6FF;">0.5</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">0.5</span><span style="color:#ADBAC7;">], </span><span style="color:#96D0FF;">&quot;k:&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot([</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">], [</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">], </span><span style="color:#96D0FF;">&quot;k:&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot([</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">], [</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1.1</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1.1</span><span style="color:#ADBAC7;">], </span><span style="color:#96D0FF;">&quot;k-&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(t, sig, </span><span style="color:#96D0FF;">&quot;b-&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">linewidth</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">label</span><span style="color:#F47067;">=</span><span style="color:#F47067;">r</span><span style="color:#96D0FF;">&quot;</span><span style="color:#6CB6FF;">$\\s</span><span style="color:#96D0FF;">igma</span><span style="color:#6CB6FF;">(</span><span style="color:#96D0FF;">t</span><span style="color:#6CB6FF;">)</span><span style="color:#96D0FF;"> = </span><span style="color:#8DDB8C;font-weight:bold;">\\f</span><span style="color:#96D0FF;">rac</span><span style="color:#F47067;">{1}</span><span style="color:#96D0FF;">{1 </span><span style="color:#F47067;">+</span><span style="color:#96D0FF;"> e</span><span style="color:#6CB6FF;">^</span><span style="color:#96D0FF;">{-t}}</span><span style="color:#6CB6FF;">$</span><span style="color:#96D0FF;">&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.xlabel(</span><span style="color:#96D0FF;">&quot;t&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.legend(</span><span style="color:#F69D50;">loc</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&quot;upper left&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">fontsize</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">20</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.axis([</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">, </span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">0.1</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1.1</span><span style="color:#ADBAC7;">])</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.title(</span><span style="color:#96D0FF;">&#39;Figure 4-21. Logistic function&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.show()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> numpy </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> np</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> os</span></span>
<span class="line"><span style="color:#D73A49;">%</span><span style="color:#24292E;">matplotlib inline</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> matplotlib</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> matplotlib.pyplot </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> plt</span></span>
<span class="line"><span style="color:#24292E;">plt.rcParams[</span><span style="color:#032F62;">&#39;axes.labelsize&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">14</span></span>
<span class="line"><span style="color:#24292E;">plt.rcParams[</span><span style="color:#032F62;">&#39;xtick.labelsize&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">12</span></span>
<span class="line"><span style="color:#24292E;">plt.rcParams[</span><span style="color:#032F62;">&#39;ytick.labelsize&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">12</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> warnings</span></span>
<span class="line"><span style="color:#24292E;">warnings.filterwarnings(</span><span style="color:#032F62;">&#39;ignore&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">np.random.seed(</span><span style="color:#005CC5;">42</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">t </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.linspace(</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">100</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">sig </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> (</span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> np.exp(</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">t))</span></span>
<span class="line"><span style="color:#24292E;">plt.figure(</span><span style="color:#E36209;">figsize</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">9</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">plt.plot([</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">], [</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&quot;k-&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot([</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">], [</span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&quot;k:&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot([</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">], [</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&quot;k:&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot([</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">], [</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1.1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1.1</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&quot;k-&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(t, sig, </span><span style="color:#032F62;">&quot;b-&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">linewidth</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#E36209;">label</span><span style="color:#D73A49;">=</span><span style="color:#D73A49;">r</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">$\\s</span><span style="color:#032F62;">igma</span><span style="color:#005CC5;">(</span><span style="color:#032F62;">t</span><span style="color:#005CC5;">)</span><span style="color:#032F62;"> = </span><span style="color:#22863A;font-weight:bold;">\\f</span><span style="color:#032F62;">rac</span><span style="color:#D73A49;">{1}</span><span style="color:#032F62;">{1 </span><span style="color:#D73A49;">+</span><span style="color:#032F62;"> e</span><span style="color:#005CC5;">^</span><span style="color:#032F62;">{-t}}</span><span style="color:#005CC5;">$</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.xlabel(</span><span style="color:#032F62;">&quot;t&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.legend(</span><span style="color:#E36209;">loc</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;upper left&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fontsize</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">20</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.axis([</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">0.1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1.1</span><span style="color:#24292E;">])</span></span>
<span class="line"><span style="color:#24292E;">plt.title(</span><span style="color:#032F62;">&#39;Figure 4-21. Logistic function&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.show()</span></span></code></pre></div><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/python/ML/7.1.png" alt=""></p><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/python/ML/7.2.png" alt=""></p><h3 id="数据集" tabindex="-1">数据集 <a class="header-anchor" href="#数据集" aria-label="Permalink to &quot;数据集&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> sklearn </span><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> datasets</span></span>
<span class="line"><span style="color:#ADBAC7;">iris </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> datasets.load_iris()</span></span>
<span class="line"><span style="color:#6CB6FF;">list</span><span style="color:#ADBAC7;">(iris.keys())</span></span>
<span class="line"><span style="color:#ADBAC7;">[</span><span style="color:#96D0FF;">&#39;data&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&#39;target&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&#39;target_names&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&#39;DESCR&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&#39;feature_names&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#96D0FF;">&#39;filename&#39;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">X </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> iris[</span><span style="color:#96D0FF;">&#39;data&#39;</span><span style="color:#ADBAC7;">][:,</span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">:]</span></span>
<span class="line"><span style="color:#ADBAC7;">y </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> (iris[</span><span style="color:#96D0FF;">&#39;target&#39;</span><span style="color:#ADBAC7;">] </span><span style="color:#F47067;">==</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">).astype(np.int)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">LogisticRegression()</span></span>
<span class="line"><span style="color:#ADBAC7;">log_res.fit(X,y)</span></span>
<span class="line"><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> sklearn.linear_model </span><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> LogisticRegression</span></span>
<span class="line"><span style="color:#ADBAC7;">log_res </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> LogisticRegression()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">log_res.fit(X,y)</span></span>
<span class="line"><span style="color:#ADBAC7;">LogisticRegression(</span><span style="color:#F69D50;">C</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">1.0</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">class_weight</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">dual</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">False</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">fit_intercept</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">True</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">intercept_scaling</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">max_iter</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">100</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">multi_class</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;warn&#39;</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">n_jobs</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">penalty</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;l2&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">random_state</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">solver</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;warn&#39;</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">tol</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0.0001</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">verbose</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">warm_start</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">False</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">X_new </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.linspace(</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1000</span><span style="color:#ADBAC7;">).reshape(</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">y_proba </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> log_res.predict_proba(X_new)</span></span>
<span class="line"><span style="color:#ADBAC7;">y_proba</span></span>
<span class="line"><span style="color:#ADBAC7;">array([[</span><span style="color:#6CB6FF;">0.98554411</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">0.01445589</span><span style="color:#ADBAC7;">],</span></span>
<span class="line"><span style="color:#ADBAC7;">       </span></span>
<span class="line"><span style="color:#ADBAC7;"> </span><span style="color:#768390;"># 随着输入特征数值的变化，结果概率值也会随之变化</span></span>
<span class="line"><span style="color:#ADBAC7;">       plt.figure(</span><span style="color:#F69D50;">figsize</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">12</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">5</span><span style="color:#ADBAC7;">))</span></span>
<span class="line"><span style="color:#ADBAC7;">decision_boundary = X_new[y_proba[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">]</span><span style="color:#F47067;">&gt;=</span><span style="color:#6CB6FF;">0.5</span><span style="color:#ADBAC7;">][</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot([decision_boundary,decision_boundary],[</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;k:&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">linewidth</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X_new,y_proba[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;g-&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">label</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;Iris-Virginica&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X_new,y_proba[:,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;b--&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">label</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;Not Iris-Virginica&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.arrow(decision_boundary,</span><span style="color:#6CB6FF;">0.08</span><span style="color:#ADBAC7;">,</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">0.3</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">head_width</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0.05</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">head_length</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0.1</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">fc</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;b&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">ec</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;b&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.arrow(decision_boundary,</span><span style="color:#6CB6FF;">0.92</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0.3</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">head_width</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0.05</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">head_length</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0.1</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">fc</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;g&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">ec</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;g&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.text(decision_boundary</span><span style="color:#F47067;">+</span><span style="color:#6CB6FF;">0.02</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0.15</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&#39;Decision Boundary&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">fontsize</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">16</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">color</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;k&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">ha</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;center&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.xlabel(</span><span style="color:#96D0FF;">&#39;Peta width(cm)&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">fontsize</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">16</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.ylabel(</span><span style="color:#96D0FF;">&#39;y_proba&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">fontsize</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">16</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.axis([</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">,</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">0.02</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1.02</span><span style="color:#ADBAC7;">])</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.legend(</span><span style="color:#F69D50;">loc</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;center left&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">fontsize</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">16</span><span style="color:#ADBAC7;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sklearn </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> datasets</span></span>
<span class="line"><span style="color:#24292E;">iris </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> datasets.load_iris()</span></span>
<span class="line"><span style="color:#005CC5;">list</span><span style="color:#24292E;">(iris.keys())</span></span>
<span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">&#39;data&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;target&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;target_names&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;DESCR&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;feature_names&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;filename&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">X </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iris[</span><span style="color:#032F62;">&#39;data&#39;</span><span style="color:#24292E;">][:,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">:]</span></span>
<span class="line"><span style="color:#24292E;">y </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (iris[</span><span style="color:#032F62;">&#39;target&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">==</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">).astype(np.int)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">LogisticRegression()</span></span>
<span class="line"><span style="color:#24292E;">log_res.fit(X,y)</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sklearn.linear_model </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> LogisticRegression</span></span>
<span class="line"><span style="color:#24292E;">log_res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LogisticRegression()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">log_res.fit(X,y)</span></span>
<span class="line"><span style="color:#24292E;">LogisticRegression(</span><span style="color:#E36209;">C</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1.0</span><span style="color:#24292E;">, </span><span style="color:#E36209;">class_weight</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">dual</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fit_intercept</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">intercept_scaling</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">max_iter</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">, </span><span style="color:#E36209;">multi_class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;warn&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">n_jobs</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">penalty</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;l2&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">random_state</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">solver</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;warn&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">tol</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0.0001</span><span style="color:#24292E;">, </span><span style="color:#E36209;">verbose</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#E36209;">warm_start</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">X_new </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.linspace(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">).reshape(</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">y_proba </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> log_res.predict_proba(X_new)</span></span>
<span class="line"><span style="color:#24292E;">y_proba</span></span>
<span class="line"><span style="color:#24292E;">array([[</span><span style="color:#005CC5;">0.98554411</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0.01445589</span><span style="color:#24292E;">],</span></span>
<span class="line"><span style="color:#24292E;">       </span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 随着输入特征数值的变化，结果概率值也会随之变化</span></span>
<span class="line"><span style="color:#24292E;">       plt.figure(</span><span style="color:#E36209;">figsize</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">12</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">decision_boundary = X_new[y_proba[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">&gt;=</span><span style="color:#005CC5;">0.5</span><span style="color:#24292E;">][</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">plt.plot([decision_boundary,decision_boundary],[</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;k:&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">linewidth</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X_new,y_proba[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;g-&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">label</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Iris-Virginica&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X_new,y_proba[:,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;b--&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">label</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;Not Iris-Virginica&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.arrow(decision_boundary,</span><span style="color:#005CC5;">0.08</span><span style="color:#24292E;">,</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">0.3</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#E36209;">head_width</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.05</span><span style="color:#24292E;">,</span><span style="color:#E36209;">head_length</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0.1</span><span style="color:#24292E;">,</span><span style="color:#E36209;">fc</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;b&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">ec</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;b&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.arrow(decision_boundary,</span><span style="color:#005CC5;">0.92</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0.3</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#E36209;">head_width</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.05</span><span style="color:#24292E;">,</span><span style="color:#E36209;">head_length</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0.1</span><span style="color:#24292E;">,</span><span style="color:#E36209;">fc</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;g&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">ec</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;g&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.text(decision_boundary</span><span style="color:#D73A49;">+</span><span style="color:#005CC5;">0.02</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0.15</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;Decision Boundary&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">fontsize</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">,</span><span style="color:#E36209;">color</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;k&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">ha</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;center&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.xlabel(</span><span style="color:#032F62;">&#39;Peta width(cm)&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">fontsize</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.ylabel(</span><span style="color:#032F62;">&#39;y_proba&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">fontsize</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.axis([</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">,</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">0.02</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1.02</span><span style="color:#24292E;">])</span></span>
<span class="line"><span style="color:#24292E;">plt.legend(</span><span style="color:#E36209;">loc</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;center left&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">fontsize</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">)</span></span></code></pre></div><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/python/ML/7.3.png" alt=""></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">X </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> iris[</span><span style="color:#96D0FF;">&#39;data&#39;</span><span style="color:#ADBAC7;">][:,(</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">)]</span></span>
<span class="line"><span style="color:#ADBAC7;">y </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> (iris[</span><span style="color:#96D0FF;">&#39;target&#39;</span><span style="color:#ADBAC7;">]</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">).astype(np.int)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> sklearn.linear_model </span><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> LogisticRegression</span></span>
<span class="line"><span style="color:#ADBAC7;">log_res </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> LogisticRegression(</span><span style="color:#F69D50;">C</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">10000</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">log_res.fit(X,y)</span></span>
<span class="line"><span style="color:#ADBAC7;">LogisticRegression(</span><span style="color:#F69D50;">C</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">10000</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">class_weight</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">dual</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">False</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">fit_intercept</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">True</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">intercept_scaling</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">max_iter</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">100</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">multi_class</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;warn&#39;</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">n_jobs</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">penalty</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;l2&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">random_state</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">solver</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;warn&#39;</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">tol</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0.0001</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">verbose</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">warm_start</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">False</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">X[:,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">].min(),X[:,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">].max()</span></span>
<span class="line"><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">1.0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">6.9</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">X[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">].min(),X[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">].max()</span></span>
<span class="line"><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">0.1</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">2.5</span><span style="color:#ADBAC7;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">X </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iris[</span><span style="color:#032F62;">&#39;data&#39;</span><span style="color:#24292E;">][:,(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">y </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (iris[</span><span style="color:#032F62;">&#39;target&#39;</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">).astype(np.int)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sklearn.linear_model </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> LogisticRegression</span></span>
<span class="line"><span style="color:#24292E;">log_res </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LogisticRegression(</span><span style="color:#E36209;">C</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10000</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">log_res.fit(X,y)</span></span>
<span class="line"><span style="color:#24292E;">LogisticRegression(</span><span style="color:#E36209;">C</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">10000</span><span style="color:#24292E;">, </span><span style="color:#E36209;">class_weight</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">dual</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fit_intercept</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">intercept_scaling</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">max_iter</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">, </span><span style="color:#E36209;">multi_class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;warn&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">n_jobs</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">penalty</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;l2&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">random_state</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">solver</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;warn&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">tol</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0.0001</span><span style="color:#24292E;">, </span><span style="color:#E36209;">verbose</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#E36209;">warm_start</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">X[:,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].min(),X[:,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">].max()</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#005CC5;">1.0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">6.9</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">X[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].min(),X[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].max()</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#005CC5;">0.1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">2.5</span><span style="color:#24292E;">)</span></span></code></pre></div><h3 id="决策边界的绘制" tabindex="-1">决策边界的绘制 <a class="header-anchor" href="#决策边界的绘制" aria-label="Permalink to &quot;决策边界的绘制&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#adbac7;">构建坐标数据，合理的范围当中，根据实际训练时输入数据来决定</span></span>
<span class="line"><span style="color:#adbac7;">整合坐标点，得到所有测试输入数据坐标点</span></span>
<span class="line"><span style="color:#adbac7;">预测，得到所有点的概率值</span></span>
<span class="line"><span style="color:#adbac7;">绘制等高线，完成决策边界</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">构建坐标数据，合理的范围当中，根据实际训练时输入数据来决定</span></span>
<span class="line"><span style="color:#24292e;">整合坐标点，得到所有测试输入数据坐标点</span></span>
<span class="line"><span style="color:#24292e;">预测，得到所有点的概率值</span></span>
<span class="line"><span style="color:#24292e;">绘制等高线，完成决策边界</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">x0,x1 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.meshgrid(np.linspace(</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">).reshape(</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">),np.linspace(</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">20</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">).reshape(</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">x0</span></span>
<span class="line"><span style="color:#ADBAC7;">array([[</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">.]])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">array([[</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [</span><span style="color:#6CB6FF;">15</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">15</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [</span><span style="color:#6CB6FF;">20</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">20</span><span style="color:#ADBAC7;">.]])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">np.c_[x0.ravel(),x1.ravel()]</span></span>
<span class="line"><span style="color:#ADBAC7;">array([[ </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [ </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [ </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">15</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [ </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">15</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [ </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">20</span><span style="color:#ADBAC7;">.],</span></span>
<span class="line"><span style="color:#ADBAC7;">       [ </span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">., </span><span style="color:#6CB6FF;">20</span><span style="color:#ADBAC7;">.]])</span></span>
<span class="line"><span style="color:#ADBAC7;">x0,x1 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.meshgrid(np.linspace(</span><span style="color:#6CB6FF;">2.9</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">7</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">500</span><span style="color:#ADBAC7;">).reshape(</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">),np.linspace(</span><span style="color:#6CB6FF;">0.8</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2.7</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">200</span><span style="color:#ADBAC7;">).reshape(</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">))</span></span>
<span class="line"><span style="color:#ADBAC7;">X_new </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.c_[x0.ravel(),x1.ravel()]</span></span>
<span class="line"><span style="color:#ADBAC7;">X_new</span></span>
<span class="line"><span style="color:#ADBAC7;">y_proba </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> log_res.predict_proba(X_new)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">plt.figure(</span><span style="color:#F69D50;">figsize</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">4</span><span style="color:#ADBAC7;">))</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">],X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;bs&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">],X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;g^&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">zz </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> y_proba[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">].reshape(x0.shape)</span></span>
<span class="line"><span style="color:#ADBAC7;">contour </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> plt.contour(x0,x1,zz,</span><span style="color:#F69D50;">cmap</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">plt.cm.brg)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.clabel(contour,</span><span style="color:#F69D50;">inline</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.axis([</span><span style="color:#6CB6FF;">2.9</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">7</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0.8</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2.7</span><span style="color:#ADBAC7;">])</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.text(</span><span style="color:#6CB6FF;">3.5</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">1.5</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&#39;NOT Vir&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">fontsize</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">16</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">color</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;b&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.text(</span><span style="color:#6CB6FF;">6.5</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2.3</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&#39;Vir&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">fontsize</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">16</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">color</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;g&#39;</span><span style="color:#ADBAC7;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">x0,x1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.meshgrid(np.linspace(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">).reshape(</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">),np.linspace(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">20</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">).reshape(</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">x0</span></span>
<span class="line"><span style="color:#24292E;">array([[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">.]])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">array([[</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [</span><span style="color:#005CC5;">15</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">15</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [</span><span style="color:#005CC5;">20</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">.]])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">np.c_[x0.ravel(),x1.ravel()]</span></span>
<span class="line"><span style="color:#24292E;">array([[ </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [ </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">10</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [ </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">15</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [ </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">15</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [ </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">.],</span></span>
<span class="line"><span style="color:#24292E;">       [ </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">., </span><span style="color:#005CC5;">20</span><span style="color:#24292E;">.]])</span></span>
<span class="line"><span style="color:#24292E;">x0,x1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.meshgrid(np.linspace(</span><span style="color:#005CC5;">2.9</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">7</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">500</span><span style="color:#24292E;">).reshape(</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">),np.linspace(</span><span style="color:#005CC5;">0.8</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2.7</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">200</span><span style="color:#24292E;">).reshape(</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">X_new </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.c_[x0.ravel(),x1.ravel()]</span></span>
<span class="line"><span style="color:#24292E;">X_new</span></span>
<span class="line"><span style="color:#24292E;">y_proba </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> log_res.predict_proba(X_new)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">plt.figure(</span><span style="color:#E36209;">figsize</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">4</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">],X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;bs&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">],X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;g^&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">zz </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> y_proba[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].reshape(x0.shape)</span></span>
<span class="line"><span style="color:#24292E;">contour </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> plt.contour(x0,x1,zz,</span><span style="color:#E36209;">cmap</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">plt.cm.brg)</span></span>
<span class="line"><span style="color:#24292E;">plt.clabel(contour,</span><span style="color:#E36209;">inline</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.axis([</span><span style="color:#005CC5;">2.9</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">7</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0.8</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2.7</span><span style="color:#24292E;">])</span></span>
<span class="line"><span style="color:#24292E;">plt.text(</span><span style="color:#005CC5;">3.5</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">1.5</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;NOT Vir&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">fontsize</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">,</span><span style="color:#E36209;">color</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;b&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.text(</span><span style="color:#005CC5;">6.5</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2.3</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;Vir&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">fontsize</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">16</span><span style="color:#24292E;">,</span><span style="color:#E36209;">color</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;g&#39;</span><span style="color:#24292E;">)</span></span></code></pre></div><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/python/ML/7.4.png" alt=""></p><h3 id="多类别分类" tabindex="-1">多类别分类 <a class="header-anchor" href="#多类别分类" aria-label="Permalink to &quot;多类别分类&quot;">​</a></h3><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/python/ML/7.5.png" alt=""></p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#ADBAC7;">X </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> iris[</span><span style="color:#96D0FF;">&#39;data&#39;</span><span style="color:#ADBAC7;">][:,(</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">)]</span></span>
<span class="line"><span style="color:#ADBAC7;">y </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> iris[</span><span style="color:#96D0FF;">&#39;target&#39;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">softmax_reg </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> LogisticRegression(</span><span style="color:#F69D50;">multi_class</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#96D0FF;">&#39;multinomial&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">solver</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;lbfgs&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">softmax_reg.fit(X,y)</span></span>
<span class="line"><span style="color:#ADBAC7;">LogisticRegression(</span><span style="color:#F69D50;">C</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">1.0</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">class_weight</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">dual</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">False</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">fit_intercept</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">True</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">intercept_scaling</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">max_iter</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">100</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">multi_class</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;multinomial&#39;</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">n_jobs</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">penalty</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;l2&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">random_state</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">solver</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;lbfgs&#39;</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">          </span><span style="color:#F69D50;">tol</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0.0001</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">verbose</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">warm_start</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">False</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">softmax_reg.predict([[</span><span style="color:#6CB6FF;">5</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">]])</span></span>
<span class="line"><span style="color:#ADBAC7;">softmax_reg.predict_proba([[</span><span style="color:#6CB6FF;">5</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">]])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">x0, x1 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.meshgrid(</span></span>
<span class="line"><span style="color:#ADBAC7;">        np.linspace(</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">8</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">500</span><span style="color:#ADBAC7;">).reshape(</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">),</span></span>
<span class="line"><span style="color:#ADBAC7;">        np.linspace(</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">3.5</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">200</span><span style="color:#ADBAC7;">).reshape(</span><span style="color:#F47067;">-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">),</span></span>
<span class="line"><span style="color:#ADBAC7;">    )</span></span>
<span class="line"><span style="color:#ADBAC7;">X_new </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.c_[x0.ravel(), x1.ravel()]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">y_proba </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> softmax_reg.predict_proba(X_new)</span></span>
<span class="line"><span style="color:#ADBAC7;">y_predict </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> softmax_reg.predict(X_new)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">zz1 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> y_proba[:, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">].reshape(x0.shape)</span></span>
<span class="line"><span style="color:#ADBAC7;">zz </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> y_predict.reshape(x0.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">plt.figure(</span><span style="color:#F69D50;">figsize</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">10</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">4</span><span style="color:#ADBAC7;">))</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">], X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">], </span><span style="color:#96D0FF;">&quot;g^&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">label</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&quot;Iris-Virginica&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">], X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">], </span><span style="color:#96D0FF;">&quot;bs&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">label</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&quot;Iris-Versicolor&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">], X[y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">], </span><span style="color:#96D0FF;">&quot;yo&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">label</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&quot;Iris-Setosa&quot;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> matplotlib.colors </span><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> ListedColormap</span></span>
<span class="line"><span style="color:#ADBAC7;">custom_cmap </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> ListedColormap([</span><span style="color:#96D0FF;">&#39;#fafab0&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&#39;#9898ff&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#96D0FF;">&#39;#a0faa0&#39;</span><span style="color:#ADBAC7;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">plt.contourf(x0, x1, zz, </span><span style="color:#F69D50;">cmap</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">custom_cmap)</span></span>
<span class="line"><span style="color:#ADBAC7;">contour </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> plt.contour(x0, x1, zz1, </span><span style="color:#F69D50;">cmap</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">plt.cm.brg)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.clabel(contour, </span><span style="color:#F69D50;">inline</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">fontsize</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">12</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.xlabel(</span><span style="color:#96D0FF;">&quot;Petal length&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">fontsize</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">14</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.ylabel(</span><span style="color:#96D0FF;">&quot;Petal width&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">fontsize</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">14</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.legend(</span><span style="color:#F69D50;">loc</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&quot;center left&quot;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">fontsize</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">14</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.axis([</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">7</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">3.5</span><span style="color:#ADBAC7;">])</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.show()</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">X </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iris[</span><span style="color:#032F62;">&#39;data&#39;</span><span style="color:#24292E;">][:,(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">y </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iris[</span><span style="color:#032F62;">&#39;target&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">softmax_reg </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LogisticRegression(</span><span style="color:#E36209;">multi_class</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;multinomial&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">solver</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;lbfgs&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">softmax_reg.fit(X,y)</span></span>
<span class="line"><span style="color:#24292E;">LogisticRegression(</span><span style="color:#E36209;">C</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1.0</span><span style="color:#24292E;">, </span><span style="color:#E36209;">class_weight</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">dual</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fit_intercept</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">intercept_scaling</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">max_iter</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">100</span><span style="color:#24292E;">, </span><span style="color:#E36209;">multi_class</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;multinomial&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">n_jobs</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">penalty</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;l2&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">random_state</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">solver</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;lbfgs&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#E36209;">tol</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0.0001</span><span style="color:#24292E;">, </span><span style="color:#E36209;">verbose</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#E36209;">warm_start</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">softmax_reg.predict([[</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">]])</span></span>
<span class="line"><span style="color:#24292E;">softmax_reg.predict_proba([[</span><span style="color:#005CC5;">5</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">]])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">x0, x1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.meshgrid(</span></span>
<span class="line"><span style="color:#24292E;">        np.linspace(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">8</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">500</span><span style="color:#24292E;">).reshape(</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">        np.linspace(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">3.5</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">200</span><span style="color:#24292E;">).reshape(</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">),</span></span>
<span class="line"><span style="color:#24292E;">    )</span></span>
<span class="line"><span style="color:#24292E;">X_new </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.c_[x0.ravel(), x1.ravel()]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">y_proba </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> softmax_reg.predict_proba(X_new)</span></span>
<span class="line"><span style="color:#24292E;">y_predict </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> softmax_reg.predict(X_new)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">zz1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> y_proba[:, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">].reshape(x0.shape)</span></span>
<span class="line"><span style="color:#24292E;">zz </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> y_predict.reshape(x0.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">plt.figure(</span><span style="color:#E36209;">figsize</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">10</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">4</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">], X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&quot;g^&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">label</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Iris-Virginica&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">], X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&quot;bs&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">label</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Iris-Versicolor&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">], X[y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">], </span><span style="color:#032F62;">&quot;yo&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">label</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;Iris-Setosa&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> matplotlib.colors </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> ListedColormap</span></span>
<span class="line"><span style="color:#24292E;">custom_cmap </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> ListedColormap([</span><span style="color:#032F62;">&#39;#fafab0&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;#9898ff&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;#a0faa0&#39;</span><span style="color:#24292E;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">plt.contourf(x0, x1, zz, </span><span style="color:#E36209;">cmap</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">custom_cmap)</span></span>
<span class="line"><span style="color:#24292E;">contour </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> plt.contour(x0, x1, zz1, </span><span style="color:#E36209;">cmap</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">plt.cm.brg)</span></span>
<span class="line"><span style="color:#24292E;">plt.clabel(contour, </span><span style="color:#E36209;">inline</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fontsize</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">12</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.xlabel(</span><span style="color:#032F62;">&quot;Petal length&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fontsize</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">14</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.ylabel(</span><span style="color:#032F62;">&quot;Petal width&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fontsize</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">14</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.legend(</span><span style="color:#E36209;">loc</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;center left&quot;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">fontsize</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">14</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.axis([</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">7</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">3.5</span><span style="color:#24292E;">])</span></span>
<span class="line"><span style="color:#24292E;">plt.show()</span></span></code></pre></div><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/python/ML/7.6.png" alt=""></p>`,19);function u(s,m,_,h,b,f){const o=t,e=i("ClientOnly");return l(),r("div",null,[d,y(e,null,{default:C(()=>{var n,a;return[(((n=s.$frontmatter)==null?void 0:n.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(l(),D(o,{key:0,article:s.$frontmatter},null,8,["article"])):B("",!0)]}),_:1}),g])}const X=c(E,[["render",u]]);export{w as __pageData,X as default};
