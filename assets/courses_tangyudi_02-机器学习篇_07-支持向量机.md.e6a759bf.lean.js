import{_ as t}from"./chunks/ArticleMetadata.59a467b2.js";import{_ as c,v as l,b as r,t as y,O as A,F as p,L as C,R as i,M as F,C as D,B}from"./chunks/framework.5cbdba25.js";import"./chunks/md5.02486a14.js";const w=JSON.parse('{"title":"支持向量机","description":"","frontmatter":{"title":"支持向量机","author":"阿源","date":"2023/07/07 12:00","categories":["机器学习快速入门"],"tags":["机器学习"]},"headers":[],"relativePath":"courses/tangyudi/02-机器学习篇/07-支持向量机.md","filePath":"courses/tangyudi/02-机器学习篇/07-支持向量机.md","lastUpdated":1691327334000}'),E={name:"courses/tangyudi/02-机器学习篇/07-支持向量机.md"},d=p("h1",{id:"支持向量机",tabindex:"-1"},[C("支持向量机 "),p("a",{class:"header-anchor",href:"#支持向量机","aria-label":'Permalink to "支持向量机"'},"​")],-1),_=i(`<h2 id="_16-支持向量机原理" tabindex="-1">16. 支持向量机原理 <a class="header-anchor" href="#_16-支持向量机原理" aria-label="Permalink to &quot;16. 支持向量机原理&quot;">​</a></h2><h2 id="_17-支持向量机实验分析" tabindex="-1">17. 支持向量机实验分析 <a class="header-anchor" href="#_17-支持向量机实验分析" aria-label="Permalink to &quot;17. 支持向量机实验分析&quot;">​</a></h2><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;"># 与传统算法进行对比，看看SVM究竟能带来什么样的效果</span></span>
<span class="line"><span style="color:#768390;"># 软间隔的作用，这么复杂的算法肯定会导致过拟合现象，如何来进行解决呢？</span></span>
<span class="line"><span style="color:#768390;"># 核函数的作用，如果只是做线性分类，好像轮不到SVM登场了，核函数才是它的强大之处！</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> numpy </span><span style="color:#F47067;">as</span><span style="color:#ADBAC7;"> np</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> os</span></span>
<span class="line"><span style="color:#F47067;">%</span><span style="color:#ADBAC7;">matplotlib inline</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> matplotlib</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> matplotlib.pyplot </span><span style="color:#F47067;">as</span><span style="color:#ADBAC7;"> plt</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.rcParams[</span><span style="color:#96D0FF;">&#39;axes.labelsize&#39;</span><span style="color:#ADBAC7;">] </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">14</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.rcParams[</span><span style="color:#96D0FF;">&#39;xtick.labelsize&#39;</span><span style="color:#ADBAC7;">] </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">12</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.rcParams[</span><span style="color:#96D0FF;">&#39;ytick.labelsize&#39;</span><span style="color:#ADBAC7;">] </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">12</span></span>
<span class="line"><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> warnings</span></span>
<span class="line"><span style="color:#ADBAC7;">warnings.filterwarnings(</span><span style="color:#96D0FF;">&#39;ignore&#39;</span><span style="color:#ADBAC7;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 与传统算法进行对比，看看SVM究竟能带来什么样的效果</span></span>
<span class="line"><span style="color:#6A737D;"># 软间隔的作用，这么复杂的算法肯定会导致过拟合现象，如何来进行解决呢？</span></span>
<span class="line"><span style="color:#6A737D;"># 核函数的作用，如果只是做线性分类，好像轮不到SVM登场了，核函数才是它的强大之处！</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> numpy </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> np</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> os</span></span>
<span class="line"><span style="color:#D73A49;">%</span><span style="color:#24292E;">matplotlib inline</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> matplotlib</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> matplotlib.pyplot </span><span style="color:#D73A49;">as</span><span style="color:#24292E;"> plt</span></span>
<span class="line"><span style="color:#24292E;">plt.rcParams[</span><span style="color:#032F62;">&#39;axes.labelsize&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">14</span></span>
<span class="line"><span style="color:#24292E;">plt.rcParams[</span><span style="color:#032F62;">&#39;xtick.labelsize&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">12</span></span>
<span class="line"><span style="color:#24292E;">plt.rcParams[</span><span style="color:#032F62;">&#39;ytick.labelsize&#39;</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">12</span></span>
<span class="line"><span style="color:#D73A49;">import</span><span style="color:#24292E;"> warnings</span></span>
<span class="line"><span style="color:#24292E;">warnings.filterwarnings(</span><span style="color:#032F62;">&#39;ignore&#39;</span><span style="color:#24292E;">)</span></span></code></pre></div><h3 id="支持向量机带来的效果" tabindex="-1">支持向量机带来的效果 <a class="header-anchor" href="#支持向量机带来的效果" aria-label="Permalink to &quot;支持向量机带来的效果&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> sklearn.svm </span><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">SVC</span></span>
<span class="line"><span style="color:#F47067;">from</span><span style="color:#ADBAC7;"> sklearn </span><span style="color:#F47067;">import</span><span style="color:#ADBAC7;"> datasets</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">iris </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> datasets.load_iris()</span></span>
<span class="line"><span style="color:#ADBAC7;">X </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> iris[</span><span style="color:#96D0FF;">&#39;data&#39;</span><span style="color:#ADBAC7;">][:,(</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">)]</span></span>
<span class="line"><span style="color:#ADBAC7;">y </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> iris[</span><span style="color:#96D0FF;">&#39;target&#39;</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">setosa_or_versicolor </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> (y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">)</span><span style="color:#F47067;">|</span><span style="color:#ADBAC7;">(y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">X </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> X[setosa_or_versicolor]</span></span>
<span class="line"><span style="color:#ADBAC7;">y </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> y[setosa_or_versicolor]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">svm_clf </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> SVC(</span><span style="color:#F69D50;">kernel</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;linear&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">C</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">float</span><span style="color:#ADBAC7;">(</span><span style="color:#96D0FF;">&#39;inf&#39;</span><span style="color:#ADBAC7;">))</span></span>
<span class="line"><span style="color:#ADBAC7;">svm_clf.fit(X,y)</span></span>
<span class="line"><span style="color:#ADBAC7;">SVC(</span><span style="color:#F69D50;">C</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">inf, </span><span style="color:#F69D50;">cache_size</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">200</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">class_weight</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">coef0</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0.0</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">decision_function_shape</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;ovr&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">degree</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">3</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">gamma</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;auto_deprecated&#39;</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">kernel</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;linear&#39;</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">max_iter</span><span style="color:#F47067;">=-</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">probability</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">False</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">random_state</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">None</span><span style="color:#ADBAC7;">,</span></span>
<span class="line"><span style="color:#ADBAC7;">  </span><span style="color:#F69D50;">shrinking</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">True</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">tol</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">0.001</span><span style="color:#ADBAC7;">, </span><span style="color:#F69D50;">verbose</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">False</span><span style="color:#ADBAC7;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sklearn.svm </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">SVC</span></span>
<span class="line"><span style="color:#D73A49;">from</span><span style="color:#24292E;"> sklearn </span><span style="color:#D73A49;">import</span><span style="color:#24292E;"> datasets</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">iris </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> datasets.load_iris()</span></span>
<span class="line"><span style="color:#24292E;">X </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iris[</span><span style="color:#032F62;">&#39;data&#39;</span><span style="color:#24292E;">][:,(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">)]</span></span>
<span class="line"><span style="color:#24292E;">y </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> iris[</span><span style="color:#032F62;">&#39;target&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">setosa_or_versicolor </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> (y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">)</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">(y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">X </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> X[setosa_or_versicolor]</span></span>
<span class="line"><span style="color:#24292E;">y </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> y[setosa_or_versicolor]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">svm_clf </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> SVC(</span><span style="color:#E36209;">kernel</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;linear&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">C</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">float</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&#39;inf&#39;</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">svm_clf.fit(X,y)</span></span>
<span class="line"><span style="color:#24292E;">SVC(</span><span style="color:#E36209;">C</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">inf, </span><span style="color:#E36209;">cache_size</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">200</span><span style="color:#24292E;">, </span><span style="color:#E36209;">class_weight</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">, </span><span style="color:#E36209;">coef0</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0.0</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">decision_function_shape</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;ovr&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">degree</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">, </span><span style="color:#E36209;">gamma</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;auto_deprecated&#39;</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">kernel</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;linear&#39;</span><span style="color:#24292E;">, </span><span style="color:#E36209;">max_iter</span><span style="color:#D73A49;">=-</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">, </span><span style="color:#E36209;">probability</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">, </span><span style="color:#E36209;">random_state</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">None</span><span style="color:#24292E;">,</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#E36209;">shrinking</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">, </span><span style="color:#E36209;">tol</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0.001</span><span style="color:#24292E;">, </span><span style="color:#E36209;">verbose</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">False</span><span style="color:#24292E;">)</span></span></code></pre></div><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark-dimmed vp-code-dark"><code><span class="line"><span style="color:#768390;"># 一般的模型</span></span>
<span class="line"><span style="color:#ADBAC7;">x0 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.linspace(</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">5.5</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">200</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">pred_1 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">5</span><span style="color:#F47067;">*</span><span style="color:#ADBAC7;">x0 </span><span style="color:#F47067;">-</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">20</span></span>
<span class="line"><span style="color:#ADBAC7;">pred_2 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> x0 </span><span style="color:#F47067;">-</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1.8</span></span>
<span class="line"><span style="color:#ADBAC7;">pred_3 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0.1</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">*</span><span style="color:#ADBAC7;"> x0 </span><span style="color:#F47067;">+</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">0.5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F47067;">def</span><span style="color:#ADBAC7;"> </span><span style="color:#DCBDFB;">plot_svc_decision_boundary</span><span style="color:#ADBAC7;">(svm_clf, xmin, xmax,sv</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">True</span><span style="color:#ADBAC7;">):</span></span>
<span class="line"><span style="color:#ADBAC7;">    w </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> svm_clf.coef_[</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">    b </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> svm_clf.intercept_[</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#6CB6FF;">print</span><span style="color:#ADBAC7;"> (w)</span></span>
<span class="line"><span style="color:#ADBAC7;">    x0 </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> np.linspace(xmin, xmax, </span><span style="color:#6CB6FF;">200</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">    decision_boundary </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#F47067;">-</span><span style="color:#ADBAC7;"> w[</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">]</span><span style="color:#F47067;">/</span><span style="color:#ADBAC7;">w[</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">] </span><span style="color:#F47067;">*</span><span style="color:#ADBAC7;"> x0 </span><span style="color:#F47067;">-</span><span style="color:#ADBAC7;"> b</span><span style="color:#F47067;">/</span><span style="color:#ADBAC7;">w[</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">    margin </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> </span><span style="color:#6CB6FF;">1</span><span style="color:#F47067;">/</span><span style="color:#ADBAC7;">w[</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">]</span></span>
<span class="line"><span style="color:#ADBAC7;">    gutter_up </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> decision_boundary </span><span style="color:#F47067;">+</span><span style="color:#ADBAC7;"> margin</span></span>
<span class="line"><span style="color:#ADBAC7;">    gutter_down </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> decision_boundary </span><span style="color:#F47067;">-</span><span style="color:#ADBAC7;"> margin</span></span>
<span class="line"><span style="color:#ADBAC7;">    </span><span style="color:#F47067;">if</span><span style="color:#ADBAC7;"> sv:</span></span>
<span class="line"><span style="color:#ADBAC7;">        svs </span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;"> svm_clf.support_vectors_</span></span>
<span class="line"><span style="color:#ADBAC7;">        plt.scatter(svs[:,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">],svs[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">],</span><span style="color:#F69D50;">s</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">180</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">facecolors</span><span style="color:#F47067;">=</span><span style="color:#96D0FF;">&#39;#FFAAAA&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">    plt.plot(x0,decision_boundary,</span><span style="color:#96D0FF;">&#39;k-&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">linewidth</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">    plt.plot(x0,gutter_up,</span><span style="color:#96D0FF;">&#39;k--&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">linewidth</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">    plt.plot(x0,gutter_down,</span><span style="color:#96D0FF;">&#39;k--&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">linewidth</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.figure(</span><span style="color:#F69D50;">figsize</span><span style="color:#F47067;">=</span><span style="color:#ADBAC7;">(</span><span style="color:#6CB6FF;">14</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">4</span><span style="color:#ADBAC7;">))</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.subplot(</span><span style="color:#6CB6FF;">121</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[:,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">][y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">],X[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">][y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;bs&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[:,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">][y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">],X[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">][y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;ys&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(x0,pred_1,</span><span style="color:#96D0FF;">&#39;g--&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">linewidth</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(x0,pred_2,</span><span style="color:#96D0FF;">&#39;m-&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">linewidth</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(x0,pred_3,</span><span style="color:#96D0FF;">&#39;r-&#39;</span><span style="color:#ADBAC7;">,</span><span style="color:#F69D50;">linewidth</span><span style="color:#F47067;">=</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.axis([</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">5.5</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ADBAC7;">plt.subplot(</span><span style="color:#6CB6FF;">122</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plot_svc_decision_boundary(svm_clf, </span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">, </span><span style="color:#6CB6FF;">5.5</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[:,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">][y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">],X[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">][y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;bs&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.plot(X[:,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">][y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">],X[:,</span><span style="color:#6CB6FF;">1</span><span style="color:#ADBAC7;">][y</span><span style="color:#F47067;">==</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">],</span><span style="color:#96D0FF;">&#39;ys&#39;</span><span style="color:#ADBAC7;">)</span></span>
<span class="line"><span style="color:#ADBAC7;">plt.axis([</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">5.5</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">0</span><span style="color:#ADBAC7;">,</span><span style="color:#6CB6FF;">2</span><span style="color:#ADBAC7;">])</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 一般的模型</span></span>
<span class="line"><span style="color:#24292E;">x0 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.linspace(</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">5.5</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">200</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">pred_1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">x0 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">20</span></span>
<span class="line"><span style="color:#24292E;">pred_2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> x0 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.8</span></span>
<span class="line"><span style="color:#24292E;">pred_3 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> x0 </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">def</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">plot_svc_decision_boundary</span><span style="color:#24292E;">(svm_clf, xmin, xmax,sv</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">True</span><span style="color:#24292E;">):</span></span>
<span class="line"><span style="color:#24292E;">    w </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> svm_clf.coef_[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    b </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> svm_clf.intercept_[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">print</span><span style="color:#24292E;"> (w)</span></span>
<span class="line"><span style="color:#24292E;">    x0 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> np.linspace(xmin, xmax, </span><span style="color:#005CC5;">200</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    decision_boundary </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> w[</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">]</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">w[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">] </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> x0 </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> b</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">w[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    margin </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">w[</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    gutter_up </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> decision_boundary </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> margin</span></span>
<span class="line"><span style="color:#24292E;">    gutter_down </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> decision_boundary </span><span style="color:#D73A49;">-</span><span style="color:#24292E;"> margin</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> sv:</span></span>
<span class="line"><span style="color:#24292E;">        svs </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> svm_clf.support_vectors_</span></span>
<span class="line"><span style="color:#24292E;">        plt.scatter(svs[:,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">],svs[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">],</span><span style="color:#E36209;">s</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">180</span><span style="color:#24292E;">,</span><span style="color:#E36209;">facecolors</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;#FFAAAA&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    plt.plot(x0,decision_boundary,</span><span style="color:#032F62;">&#39;k-&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">linewidth</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    plt.plot(x0,gutter_up,</span><span style="color:#032F62;">&#39;k--&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">linewidth</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    plt.plot(x0,gutter_down,</span><span style="color:#032F62;">&#39;k--&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">linewidth</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.figure(</span><span style="color:#E36209;">figsize</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">14</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">4</span><span style="color:#24292E;">))</span></span>
<span class="line"><span style="color:#24292E;">plt.subplot(</span><span style="color:#005CC5;">121</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[:,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">][y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">],X[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">][y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;bs&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[:,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">][y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">],X[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">][y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;ys&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(x0,pred_1,</span><span style="color:#032F62;">&#39;g--&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">linewidth</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(x0,pred_2,</span><span style="color:#032F62;">&#39;m-&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">linewidth</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(x0,pred_3,</span><span style="color:#032F62;">&#39;r-&#39;</span><span style="color:#24292E;">,</span><span style="color:#E36209;">linewidth</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.axis([</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">5.5</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">plt.subplot(</span><span style="color:#005CC5;">122</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plot_svc_decision_boundary(svm_clf, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">5.5</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[:,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">][y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">],X[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">][y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;bs&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.plot(X[:,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">][y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">],X[:,</span><span style="color:#005CC5;">1</span><span style="color:#24292E;">][y</span><span style="color:#D73A49;">==</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">],</span><span style="color:#032F62;">&#39;ys&#39;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">plt.axis([</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">5.5</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">0</span><span style="color:#24292E;">,</span><span style="color:#005CC5;">2</span><span style="color:#24292E;">])</span></span></code></pre></div><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/python/ML/15.14.png" alt=""></p><h3 id="数据标准化的影响" tabindex="-1">数据标准化的影响 <a class="header-anchor" href="#数据标准化的影响" aria-label="Permalink to &quot;数据标准化的影响&quot;">​</a></h3><p><img src="https://cdn.staticaly.com/gh/clint-sfy/blogcdn@master/python/ML/15.15.png" alt=""></p>`,9);function m(s,h,u,g,b,f){const o=t,e=F("ClientOnly");return l(),r("div",null,[d,y(e,null,{default:A(()=>{var n,a;return[(((n=s.$frontmatter)==null?void 0:n.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(l(),D(o,{key:0,article:s.$frontmatter},null,8,["article"])):B("",!0)]}),_:1}),_])}const X=c(E,[["render",m]]);export{w as __pageData,X as default};
