import{_ as l}from"./chunks/ArticleMetadata.CDaExH3F.js";import{_ as e,C as r,c as d,o as h,k,G as C,P as g,a as y,w as F,b as A,e as B}from"./chunks/framework.CZWML48V.js";import"./chunks/md5.DoRRH4_b.js";const b=JSON.parse('{"title":"关联规则","description":"","frontmatter":{"title":"关联规则","author":"阿源","date":"2023/07/10 12:00","categories":["机器学习快速入门"],"tags":["机器学习"]},"headers":[],"relativePath":"courses/tangyudi/02-机器学习篇/10-关联规则.md","filePath":"courses/tangyudi/02-机器学习篇/10-关联规则.md","lastUpdated":1713341239000}'),D={name:"courses/tangyudi/02-机器学习篇/10-关联规则.md"};function o(i,s,c,E,m,u){const p=l,t=r("ClientOnly");return h(),d("div",null,[s[0]||(s[0]=k("h1",{id:"关联规则",tabindex:"-1"},[y("关联规则 "),k("a",{class:"header-anchor",href:"#关联规则","aria-label":'Permalink to "关联规则"'},"​")],-1)),C(t,null,{default:F(()=>{var a,n;return[(((a=i.$frontmatter)==null?void 0:a.aside)??!0)&&(((n=i.$frontmatter)==null?void 0:n.showArticleMetadata)??!0)?(h(),A(p,{key:0,article:i.$frontmatter},null,8,["article"])):B("",!0)]}),_:1}),s[1]||(s[1]=g(`<h2 id="_22-关联规则实战分析" tabindex="-1">22. 关联规则实战分析 <a class="header-anchor" href="#_22-关联规则实战分析" aria-label="Permalink to &quot;22. 关联规则实战分析&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span>关联规则</span></span>
<span class="line"><span>在美国，一些年轻的父亲下班后经常要到超市去买婴儿尿布，超市也因此发现了一个规律，在购买婴儿尿布的年轻父亲们中，有30%～40%的人同时要买一些啤酒。超市随后调整了货架的摆放，把尿布和啤酒放在一起，明显增加了销售额。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>若两个或多个变量的取值之间存在某种规律性，就称为关联</span></span>
<span class="line"><span>关联规则是寻找在同一个事件中出现的不同项的相关性，比如在一次购买活动中所买不同商品的相关性。</span></span>
<span class="line"><span>“在购买计算机的顾客中，有30％的人也同时购买了打印机”</span></span>
<span class="line"><span></span></span>
<span class="line"><span>一个样本称为一个“事务”</span></span>
<span class="line"><span>每个事务由多个属性来确定，这里的属性称为“项”</span></span>
<span class="line"><span>多个项组成的集合称为“项集”</span></span>
<span class="line"><span></span></span>
<span class="line"><span>由k个项构成的集合</span></span>
<span class="line"><span>{牛奶}、{啤酒}都是1-项集；</span></span>
<span class="line"><span>{牛奶，果冻}是2-项集；</span></span>
<span class="line"><span>{啤酒，面包，牛奶}是3-项集</span></span>
<span class="line"><span>X==&gt;Y含义：</span></span>
<span class="line"><span>X和Y是项集</span></span>
<span class="line"><span>X称为规则前项（antecedent）</span></span>
<span class="line"><span>Y称为规则后项（consequent）</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span>事务仅包含其涉及到的项目，而不包含项目的具体信息。</span></span>
<span class="line"><span>在超级市场的关联规则挖掘问题中事务是顾客一次购物所购买的商品，但事务中并不包含这些商品的具体信息，如商品的数量、价格等。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>支持度（support）：一个项集或者规则在所有事务中出现的频率，σ(X):表示项集X的支持度计数</span></span>
<span class="line"><span>项集X的支持度：s(X)=σ(X)/N</span></span>
<span class="line"><span>规则X==&gt;Y表示物品集X对物品集Y的支持度，也就是物品集X和物品集Y同时出现的概率</span></span>
<span class="line"><span>某天共有100个顾客到商场购买物品，其中有30个顾客同时购买了啤酒和尿布，那么上述的关联规则的支持度就是30％</span></span>
<span class="line"><span></span></span>
<span class="line"><span>置信度（confidence）：确定Y在包含X的事务中出现的频繁程度。c(X → Y) = σ(X∪Y)/σ(X)</span></span>
<span class="line"><span>p（Y│X）＝p（XY）/p(X)。</span></span>
<span class="line"><span>置信度反应了关联规则的可信度—购买了项目集X中的商品的顾客同时也购买了Y中商品的可能性有多大</span></span>
<span class="line"><span>购买薯片的顾客中有50％的人购买了可乐,则置信度为50％</span></span></code></pre></div><p><img src="https://cdn.jsdelivr.net/gh/clint-sfy/blogcdn@master/python/ML/22.1.png" alt=""></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span>设最小支持度为50%, 最小可信度为 50%, 则可得到 :</span></span>
<span class="line"><span>A==&gt;C (50%, 66.6%)</span></span>
<span class="line"><span>C==&gt;A (50%, 100%)</span></span>
<span class="line"><span>若关联规则X-&gt;Y的支持度和置信度分别大于或等于用户指定的最小支持率minsupport和最小置信度minconfidence，则称关联规则X-&gt;Y为强关联规则，否则称关联规则X-&gt;Y为弱关联规则。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>提升度（lift）：物品集A的出现对物品集B的出现概率发生了多大的变化</span></span>
<span class="line"><span>lift（A==&gt;B）=confidence（A==&gt;B）/support(B)=p(B|A)/p(B)</span></span>
<span class="line"><span>现在有** 1000 ** 个消费者，有** 500** 人购买了茶叶，其中有** 450人同时** 购买了咖啡，另** 50人** 没有。由于** confidence(茶叶=&gt;咖啡)=450/500=90%** ，由此可能会认为喜欢喝茶的人往往喜欢喝咖啡。但如果另外没有购买茶叶的** 500人** ，其中同样有** 450人** 购买了咖啡，同样是很高的** 置信度90%** ,由此，得到不爱喝茶的也爱喝咖啡。这样看来，其实是否购买咖啡，与有没有购买茶叶并没有关联，两者是相互独立的，其** 提升度90%/[(450+450)/1000]=1** 。</span></span>
<span class="line"><span>由此可见，lift正是弥补了confidence的这一缺陷，if lift=1,X与Y独立，X对Y出现的可能性没有提升作用，其值越大(lift&gt;1),则表明X对Y的提升程度越大，也表明关联性越强。</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Leverage 与 Conviction的作用和lift类似，都是值越大代表越关联</span></span>
<span class="line"><span>Leverage :P(A,B)-P(A)P(B)</span></span>
<span class="line"><span>Conviction:P(A)P(!B)/P(A,!B)</span></span></code></pre></div><h3 id="使用mlxtend工具包得出频繁项集与规则" tabindex="-1">使用mlxtend工具包得出频繁项集与规则 <a class="header-anchor" href="#使用mlxtend工具包得出频繁项集与规则" aria-label="Permalink to &quot;使用mlxtend工具包得出频繁项集与规则&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> pandas </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> pd</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> mlxtend.frequent_patterns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> apriori</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> mlxtend.frequent_patterns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> association_rules</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">       &#39;Onion&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">       &#39;Potato&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">       &#39;Burger&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">       &#39;Milk&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">       &#39;Beer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> pd.DataFrame(data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">df </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> df[[</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Onion&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Potato&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Burger&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Milk&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Beer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ]]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 选择最小支持度为50%</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># apriori(df, min_support=0.5, use_colnames=True)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">frequent_itemsets </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> apriori(df[[</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Onion&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Potato&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Burger&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Milk&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Beer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ]], </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">min_support</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0.50</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">use_colnames</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">frequent_itemsets</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">support	itemsets</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Onion)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.833333</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Potato)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Burger)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Milk)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">4</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Potato, Onion)</span></span></code></pre></div><h3 id="计算规则" tabindex="-1">计算规则 <a class="header-anchor" href="#计算规则" aria-label="Permalink to &quot;计算规则&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># association_rules(df, metric=&#39;lift&#39;, min_threshold=1)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 可以指定不同的衡量标准与最小阈值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">rules </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> association_rules(frequent_itemsets, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">metric</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;lift&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">min_threshold</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">rules</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">antecedents	consequents	antecedent support	consequent support	support	confidence	lift	leverage	conviction</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Potato)	(Onion)	</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0.833333</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.80</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.200</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.111111</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.666667</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Onion)	(Potato)	</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.833333</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.00</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.200</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.111111</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	inf</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Burger)	(Onion)	</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.500000</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.75</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.125</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.055556</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.333333</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 返回的是各个的指标的数值，可以按照感兴趣的指标排序观察,但具体解释还得参考实际数据的含义。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">rules [ (rules[</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;lift&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1.125</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)  </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (rules[</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;confidence&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> 0.8</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)  ]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">antecedents	consequents	antecedent support	consequent support	support	confidence	lift	leverage	conviction</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Onion)	(Potato)	</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.833333</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.2</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.111111</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	inf</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Burger)	(Potato)	</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.833333</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.666667</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.2</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.111111</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	inf</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	(Burger, Onion)	(Potato)	</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0.500000</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.833333</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.500000</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1.2</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0.083333</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	inf</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 这几条结果就比较有价值了：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">#（洋葱和马铃薯）（汉堡和马铃薯）可以搭配着来卖</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 如果洋葱和汉堡都在购物篮中, 顾客买马铃薯的可能性也比较高，如果他篮子里面没有，可以推荐一下.</span></span></code></pre></div><h3 id="所有指标的计算公式" tabindex="-1">所有指标的计算公式 <a class="header-anchor" href="#所有指标的计算公式" aria-label="Permalink to &quot;所有指标的计算公式&quot;">​</a></h3><p><img src="https://cdn.jsdelivr.net/gh/clint-sfy/blogcdn@master/python/ML/22.2.png" alt=""></p><h3 id="数据需转换成one-hot编码" tabindex="-1">数据需转换成one-hot编码 <a class="header-anchor" href="#数据需转换成one-hot编码" aria-label="Permalink to &quot;数据需转换成one-hot编码&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_shopping_basket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:[</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">                         &#39;Basket&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">:[[</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Beer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Diaper&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Pretzels&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Chips&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Aspirin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                                   [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Diaper&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Beer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Chips&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Lotion&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Juice&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;BabyFood&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Milk&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                                   [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Soda&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Chips&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Milk&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                                   [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Soup&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Beer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Diaper&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Milk&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;IceCream&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                                   [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Soda&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Coffee&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Milk&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Bread&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                                   [</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Beer&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Chips&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                                  ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">                         }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> pd.DataFrame(retail_shopping_basket)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> retail[[</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Basket&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">]]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">pd.options.display.max_colwidth</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">100</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">ID</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	Basket</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	[Beer, Diaper, Pretzels, Chips, Aspirin]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> retail.drop(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Basket&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> ,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_Basket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> retail.Basket.str.join(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;,&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_Basket</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_Basket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> retail_Basket.str.get_dummies(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;,&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_Basket</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_Basket </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> retail_Basket.str.get_dummies(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;,&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail_Basket</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">Aspirin	BabyFood	Beer	Bread	Chips	Coffee	Diaper	IceCream	Juice	Lotion	Milk	Pretzels	Soda	Soup</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">retail </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> retail_id.join(retail_Basket)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">frequent_itemsets_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> apriori(retail.drop(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;ID&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">), </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">use_colnames</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 如果光考虑支持度support(X&gt;Y), [Beer, Chips] 和 [Beer, Diaper] 都是很频繁的，哪一种组合更相关呢？</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">association_rules(frequent_itemsets_2, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">metric</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;lift&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span></code></pre></div><h3 id="电影相关联" tabindex="-1">电影相关联 <a class="header-anchor" href="#电影相关联" aria-label="Permalink to &quot;电影相关联&quot;">​</a></h3><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> pd.read_csv(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;ml-latest-small/movies.csv&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movies.head(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movieId	     title	              genres</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	Toy Story (</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1995</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)	Adventure</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">Animation</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">Children</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">Comedy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">Fantasy</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">	2</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">	Jumanji (</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1995</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)	Adventure</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">Children</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">Fantasy</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movies_ohe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> movies.drop(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;genres&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">).join(movies.genres.str.get_dummies())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">pd.options.display.max_columns</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">100</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movies_ohe.head()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># 数据集包括9125部电影，一共有20种不同类型。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movies_ohe.shape</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">9125</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">22</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movies_ohe.set_index([</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;movieId&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;title&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">],</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">inplace</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">frequent_itemsets_movies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> apriori(movies_ohe,</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">use_colnames</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">min_support</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">0.025</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">rules_movies </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  association_rules(frequent_itemsets_movies, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">metric</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;lift&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">min_threshold</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">1.25</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">rules_movies[(rules_movies.lift</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)].sort_values(</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">by</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;lift&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">], </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">ascending</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">False</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># Children和Animation 这俩题材是最相关的了，常识也可以分辨出来。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movies[(movies.genres.str.contains(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Children&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">movies.genres.str.contains(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;Animation&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">))]</span></span></code></pre></div><h2 id="_23-关联规则代码实现" tabindex="-1">23. 关联规则代码实现 <a class="header-anchor" href="#_23-关联规则代码实现" aria-label="Permalink to &quot;23. 关联规则代码实现&quot;">​</a></h2>`,16))])}const P=e(D,[["render",o]]);export{b as __pageData,P as default};
